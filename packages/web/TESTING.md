# 测试指南

## 本地开发测试

### 1. 启动后端服务器

```bash
cd packages/server
npm run dev
```

后端服务器将在 `http://localhost:3000` 启动。

### 2. 启动前端开发服务器

```bash
cd packages/web
npm run dev
```

前端开发服务器将在 `http://localhost:5173` 启动，并自动代理 `/api` 请求到后端。

### 3. 打开浏览器

访问 `http://localhost:5173`，你应该能看到 Qwen Code Web 界面。

## 功能测试清单

### 基础聊天功能

- [ ] 发送消息后，用户消息立即显示在右侧（蓝色背景）
- [ ] AI 响应以打字机效果逐字显示
- [ ] 消息自动滚动到底部
- [ ] 响应完成后，打字机效果停止

### 流式响应测试

- [ ] 增量模式：每次只显示新增的内容片段
- [ ] 全量模式：每次显示完整累积内容（需要修改代码测试）

### 工具调用展示

- [ ] 工具调用请求显示为蓝色卡片
- [ ] 工具执行开始显示为黄色卡片（带动画）
- [ ] 工具执行完成显示为绿色卡片
- [ ] 工具执行错误显示为红色卡片

### 错误处理

- [ ] 网络错误时显示错误提示
- [ ] 可以点击错误提示的关闭按钮清除错误
- [ ] 错误不影响后续消息发送

### 会话管理

- [ ] 首次发送消息时自动创建会话
- [ ] 会话ID显示在顶部
- [ ] 同一会话中的消息保持上下文

### UI/UX 测试

- [ ] 响应式设计：在不同屏幕尺寸下正常显示
- [ ] 暗色模式：切换系统主题时自动适配（如果实现了）
- [ ] 滚动条样式：自定义滚动条正常显示
- [ ] Markdown 渲染：代码块、列表、链接等正常显示

### 边界情况测试

- [ ] 快速连续发送多条消息
- [ ] 在流式响应过程中取消请求
- [ ] 网络断开后重连
- [ ] 发送空消息（应该被阻止）
- [ ] 发送超长消息

## 测试用例示例

### 测试用例 1：基础对话

1. 在输入框输入："Hello, Qwen Code!"
2. 点击发送或按 Enter
3. 验证：
   - 用户消息立即显示
   - AI 响应以打字机效果显示
   - 响应完成后停止打字机效果

### 测试用例 2：代码生成和执行

1. 输入："生成一个 Python 快速排序函数并执行"
2. 验证：
   - AI 生成代码
   - 显示工具调用请求（write_file）
   - 显示工具执行开始
   - 显示工具执行完成
   - 显示执行结果

### 测试用例 3：取消请求

1. 发送一条消息
2. 在 AI 响应过程中点击"取消"按钮
3. 验证：
   - 流式响应停止
   - 显示已生成的部分内容
   - 可以继续发送新消息

### 测试用例 4：错误处理

1. 停止后端服务器
2. 尝试发送消息
3. 验证：
   - 显示错误提示
   - 错误信息清晰
   - 可以关闭错误提示

## 性能测试

- [ ] 大量消息（100+）时的滚动性能
- [ ] 快速打字机效果时的渲染性能
- [ ] 工具调用节点频繁更新时的性能

## 浏览器兼容性

- [ ] Chrome/Edge（推荐）
- [ ] Firefox
- [ ] Safari
- [ ] 移动浏览器（iOS Safari, Chrome Mobile）

## 已知问题

如果发现任何问题，请记录在 Issue 中。

## 调试技巧

### 查看网络请求

1. 打开浏览器开发者工具（F12）
2. 切换到 Network 标签
3. 查看 `/api/chat/stream` 请求
4. 检查 SSE 事件流

### 查看控制台日志

1. 打开浏览器开发者工具（F12）
2. 切换到 Console 标签
3. 查看错误和警告信息

### 检查状态

在浏览器控制台中运行：

```javascript
// 查看当前消息状态（需要暴露 store）
// 这需要在开发模式下实现
```

## 集成测试

### 端到端测试流程

1. 启动后端和前端
2. 打开浏览器访问前端
3. 执行完整的对话流程
4. 验证所有功能正常

### 自动化测试

目前还没有自动化测试，建议添加：

- E2E 测试（使用 Playwright 或 Cypress）
- 单元测试（使用 Vitest）
- 组件测试（使用 React Testing Library）
